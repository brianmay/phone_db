<nav class="navbar navbar-expand-md navbar-dark bg-dark">
    <.link navigate={Routes.page_path(@conn, :index)} class="navbar-brand">
        PhoneDb
    </.link>
    <button
    class="navbar-toggler"
    type="button"
    data-bs-toggle="collapse"
    data-bs-target="#navbarsExampleDefault"
    aria-controls="navbarsExampleDefault"
    aria-expanded="false"
    aria-label="Toggle navigation"
    >
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarsExampleDefault">
    <ul class="navbar-nav mr-auto">
        <% user = PhoneDbWeb.Auth.current_user(@conn) %>
        <% active = assigns[:active] %>
        <%= if user != nil do %>
            <li class="nav-item">
                <.link navigate={Routes.list_contact_path(@conn, :index)} class={link_class(active, "contacts")}>
                    Contacts
                </.link>
            </li>
            <li class="nav-item">
                <.link navigate={Routes.list_phone_call_path(@conn, :index)} class={link_class(active, "phone_calls")}>
                    Calls
                </.link>
            </li>
            <li class="nav-item">
                <.link navigate={Routes.default_path(@conn, :index)} class={link_class(active, "defaults")}>
                    Calls
                </.link>
            </li>
            <%= if PhoneDbWeb.Auth.user_is_admin?(user) do %>
                <li class="nav-item">
                    <.link navigate={Routes.live_dashboard_path(@conn, :home)} class={link_class(active, "dashboard")}>
                        Dashboard
                    </.link>
                </li>
            <% end %>
            <li class="nav-item dropdown">
                <a
                class="nav-link dropdown-toggle"
                href="#"
                data-bs-toggle="dropdown"
                aria-expanded="false"
                >
                <%= user["name"] %>
                </a>
                <div class="dropdown-menu">
                <%= link "Logout", to: Routes.page_path(@conn, :logout), method: :post, class: "dropdown-item" %>
                </div>
            </li>
        <% else %>
            <li class="nav-item">
                <.link navigate={Routes.page_path(@conn, :login)} class={link_class(active, "login")}>
                    Login
                </.link>
            </li>
        <% end %>
    </ul>
    </div>
</nav>

<main role="main" class="container">
    <%= for {flash_key, flash_message} <- @flash do %>
        <p class={"alert alert-#{flash_key}"}><%= flash_message %></p>
    <% end %>
    <%= @inner_content %>
</main>
